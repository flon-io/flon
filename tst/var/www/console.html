
<!DOCTYPE HTML>

<html>
  <head>
    <title>flon</title>
    <link href="css/flon.css" rel="stylesheet" />
  </head>

  <body>

    <div class="panes">

      <div class="left-pane">

        <h1>flon</h1>

        <div class="tabs">
          <div id="postFormTab" class="tab selected">post</div>
          <div id="inspectorTab" class="tab">inspect</div>
        </div>

        <div id="postForm" class="sub-pane">
          <h2>post to /i/in</h2>
          <p>
            <textarea id="inField">
            </textarea>
            <input id="inSubmit" type="submit" />
          </p>
        </div>

        <div id="inspector" class="sub-pane">
          <h2>inspect something</h2>
          nothing
        </div>
      </div>

      <div class="right-pane">

        <div id="log">
        </div>
      </div>
    </div>

    <script src="js/flon.js"></script>

    <script>

      function inOnError(e)
      {
        console.log(e);
      }
      function inOnLoad(e)
      {
        console.log(e.target);
        var elt = document.createElement('div');
        elt.textContent = e.target.responseText;
        document.getElementById('log').appendChild(elt);
      }

      function inSubmit()
      {
        var req = new XMLHttpRequest();
        req.open('POST', './i/in', true);
        req.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');
        req.onerror = inOnError;
        req.onload = inOnLoad;
        req.send(document.getElementById("inField").value);
      }

      function onTabClick(e)
      {
        byclass("tab").forEach(function(e) { e.classList.remove('selected'); });
        e.target.classList.add('selected');

        byclass("sub-pane").forEach(function(e) { e.style.display = 'none' });
        byid(e.target.id.slice(0, -3)).style.display = 'block';
      }

      document.addEventListener('DOMContentLoaded', function() {

        byid("inSubmit").addEventListener('click', inSubmit);

        byclass("tab").forEach(function(e) {
          console.log(e);
          e.addEventListener('click', onTabClick);
        });

        byid("inField").textContent = byid("launchJson").textContent;
        byid("postForm").style.display = 'block';
      });
    </script>

    <div id="launchJson" class="hidden">
{
  domain: org.example
  execute:
    [ sequence, {}, [
      [ invoke, { _0: stamp, color: red }, [] ]
      [ invoke, { _0: stamp, color: green }, [] ]
      [ invoke, { _0: stamp, color: blue }, [] ]
    ] ]
  payload: {
    hello: world
  }
}
    </div>
  </body>
</html>

